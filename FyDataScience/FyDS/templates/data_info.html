{% extends 'base.html' %}

{% block content %}

<h3> Ações </h3>
<form method="post">
    {% csrf_token %}
    <div class="d-flex align-items-center">
      <div class="mb-3 me-2">
            <input type="text" name="simbolo" class="form-control form-control-sm w-auto" placeholder="(ex: AAPL, PETR4.SA)">
        </div>
        <div class="mb-3 me-2">
        <select name="periodo" class="form-select form-select-sm w-auto">
        <option value="1d">Diário</option>
        <option value="5d">Últimos 5 dias</option>
        <option value="1wk">Semanal</option>
        <option value="1mo">Mensal</option>
        <option value="3mo">Trimestral</option>
        <option value="6mo">Semestral</option>
        <option value="1y">Anual</option>
        </select>
    </div>
</div>
    <button type="submit" class="btn btn-primary">Buscar</button>
</form>

{% if erro %}
    <div class="alert alert-danger mt-3">{{ erro }}</div>
{% endif %}

{% if dados_disponiveis %}
    <h3 class="mt-4"> {{simbolo}}</h3>
    <h4 class="mt-2">Últimos dados:</h4>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Data</th>
                <th>Abertura</th>
                <th>Fechamento</th>
                <th>Alta</th>
                <th>Baixa</th>
                <th>Volume</th>
            </tr>
        </thead>
        <tbody>
            {% for data, row in dados_acao.iterrows %}
            <tr>
                <td>{{ data.date }}</td>
                <td>{{ row.Open }}</td>
                <td>{{ row.Close }}</td>
                <td>{{ row.High }}</td>
                <td>{{ row.Low }}</td>
                <td>{{ row.Volume }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endif %}

{% if info_geral %}
    <h4 class="mt-4">Analise Simplificada:</h4>
    <ul class="list-group">
        <li class="list-group-item"><strong>Média do Preço (Fechamento): </strong> {{moeda}} {{ media|floatformat:2}}</li>
        <li class="list-group-item"><strong>Moda do Preço (Fechamento):</strong> {{moeda}} {{moda|floatformat:2}}</li>
        <li class="list-group-item"><strong>Mediana do Preço (Fechamento):</strong> {{moeda}} {{mediana|floatformat:2}}</li>
    </ul>
    <h4 class="mt-4">Informações gerais:</h4>
    <ul class="list-group">
        <li class="list-group-item"><strong>Nome:</strong> {{ info_geral.longName }}</li>
        <li class="list-group-item"><strong>Setor:</strong> {{ info_geral.sector }}</li>
        <li class="list-group-item"><strong>Indústria:</strong> {{ info_geral.industry }}</li>
        <li class="list-group-item"><strong>CEO:</strong> {{ info_geral.ceo }}</li>
        <li class="list-group-item"><strong>Localização:</strong> {{ info_geral.address1 }}, {{ info_geral.city }}, {{ info_geral.state }}</li>
        <li class="list-group-item"><strong>Moeda:</strong> {{ info_geral.moeda }} </li>
        <li class="list-group-item"><strong>Website:</strong> <a href="{{ info_geral.website }}" target="_blank">{{ info_geral.website }}</a></li>
        <li class="list-group-item"><strong>Descrição:</strong> {{ info_geral.longBusinessSummary }}</li>
    </ul>
{% endif %}

{% endblock %}
